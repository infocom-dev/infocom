<template>
  <div class="v-forrm p-0">
    <b-container fluid>
      <b-row align-v="center" class="text-center ml-5">
        <div class="col-1 pl-2 mt-5 text-left">
          <i class="fas fa-search projects-icon"></i>
        </div>
        <div class="col mt-5 p-0 text-left">
          <h3>Guide to start new project</h3>
        </div>
      </b-row>
      <b-row align-v="center" class="text-center">
        <b-col class="w-100 m-5 anketa-box p-3">
          <b-row>
            <b-col class="col-3">
              <svg
                height="512"
                viewBox="0 0 511.999 511.999"
                width="512"
                xmlns="http://www.w3.org/2000/svg"
              >
                <defs>
                  <path
                    clip-rule="evenodd"
                    d="M406.462 464.223c0 7.091-.387 13.022-1.16 17.921-.774 4.899-1.805 8.896-3.223 11.733-1.289 2.965-2.966 5.028-4.642 6.188a10.269 10.269 0 01-6.06 1.934H121.009c-1.934 0-3.868-.645-5.673-1.934-1.676-1.16-3.223-3.223-4.642-6.188-1.418-2.837-2.449-6.834-3.223-11.733s-1.16-10.83-1.16-17.921c0-7.22.258-13.28.902-18.308.645-4.899 1.676-8.767 3.094-11.862 1.418-2.966 2.966-5.157 4.771-6.576 1.676-1.418 3.739-2.063 5.931-2.063h91.283V107.471l-78.519 43.321c-5.673 2.708-10.443 4.512-14.054 5.157-3.739.516-6.575-.129-8.767-2.321-2.063-2.192-3.481-5.802-4.255-11.088-.773-5.286-1.16-12.764-1.16-22.305 0-6.06.129-11.088.387-14.956s.903-7.22 1.934-9.928c.903-2.836 2.321-5.028 4.126-6.833 1.676-1.805 4.126-3.61 7.091-5.673l104.95-67.946c1.289-1.031 2.836-1.805 4.642-2.449 1.934-.645 4.384-1.16 7.478-1.547 2.965-.387 6.962-.645 11.861-.773 4.9-.13 11.217-.13 19.082-.13 9.541 0 17.277.129 23.208.516s10.443 1.031 13.409 1.934c3.095.902 5.029 2.063 6.06 3.61s1.547 3.352 1.547 5.673v403.682h79.937c2.32 0 4.383.645 6.318 2.063 1.934 1.418 3.481 3.61 4.899 6.576 1.418 3.094 2.45 6.962 3.095 11.862.643 5.027.901 11.087.901 18.307z"
                    fill="#FFD037"
                    fill-rule="evenodd"
                    id="a"
                  />
                  <path
                    fill="#274C77"
                    id="b"
                    d="M415.475 444.61c-.768-5.827-2.049-10.644-3.918-14.723a3.436 3.436 0 00-.07-.15c-2.238-4.68-4.782-7.96-8.008-10.325-3.619-2.652-7.733-3.997-12.23-3.997h-69.938V21.732c0-4.236-1.086-8.013-3.225-11.218-2.378-3.568-6.148-6.071-11.524-7.648-3.721-1.125-8.83-1.887-15.613-2.329C285.268.166 277.909 0 267.088 0c-7.996 0-14.313 0-19.345.132-5.267.138-9.604.426-12.839.848-3.715.464-6.789 1.113-9.399 1.982l-.201.069c-2.763.986-5.081 2.2-7.066 3.701L113.641 74.45a8.94 8.94 0 00-.277.187c-3.656 2.544-6.378 4.602-8.581 6.942-2.908 2.947-5.049 6.468-6.366 10.471-1.321 3.563-2.152 7.788-2.47 12.565-.271 4.083-.409 9.338-.409 15.62 0 10.16.414 17.93 1.266 23.754 1.073 7.327 3.319 12.723 6.867 16.492l.212.22c4.391 4.389 10.178 6.123 17.204 5.154.131-.018.261-.039.391-.062 4.389-.784 9.82-2.739 16.604-5.978.177-.084.351-.174.522-.269l63.688-35.138.003 97.033c0 5.523 4.478 10 10 10s10-4.478 10-10l-.003-113.972a10 10 0 00-14.831-8.756l-78.256 43.176c-5.922 2.811-9.253 3.827-11.043 4.176a5.99 5.99 0 01-.301.03c-.35-.77-.87-2.281-1.269-5.004-.7-4.787-1.055-11.805-1.055-20.858 0-5.842.123-10.65.365-14.291.241-3.623.841-5.825 1.301-7.034.066-.173.127-.349.184-.525.364-1.144.878-2.006 1.667-2.794a9.33 9.33 0 00.258-.269c1.039-1.119 3.169-2.663 5.339-4.176L229.458 23.29c.279-.181.548-.375.807-.582.176-.141.623-.429 1.659-.807 1.321-.429 3.158-.791 5.512-1.086 2.606-.34 6.251-.573 10.83-.693C253.036 20 259.237 20 267.088 20c10.369 0 17.326.152 22.558.494 6.808.444 9.906 1.145 11.146 1.521l.113.034c.147.043.282.084.405.124v403.241c0 5.522 4.478 10 10 10h79.938c.14 0 .216.012.226.014.016.007.079.039.179.113.027.02.676.512 1.755 2.749.995 2.2 1.748 5.203 2.233 8.896.553 4.311.821 9.883.821 17.036 0 6.495-.35 12-1.038 16.362-.809 5.122-1.691 7.623-2.289 8.818-.08.16-.156.323-.228.487-.622 1.428-1.171 1.95-1.164 1.953l-.119.084c-.076.055-.1.071-.246.071H121.255a2.643 2.643 0 01-.106-.07c-.133-.144-.672-.775-1.433-2.366a7.424 7.424 0 00-.076-.155c-.599-1.198-1.482-3.701-2.291-8.823-.689-4.363-1.039-9.867-1.039-16.361 0-7.151.269-12.724.818-17.003.49-3.726 1.243-6.729 2.237-8.929.924-1.915 1.584-2.658 1.809-2.876h91.118c5.523 0 10-4.478 10-10V311.443c0-5.522-4.477-10-10-10s-10 4.478-10 10v103.972h-81.283c-4.617 0-8.848 1.489-12.249 4.31-2.926 2.341-5.372 5.618-7.474 10.014l-.07.149c-1.869 4.079-3.15 8.896-3.921 14.755-.671 5.235-.984 11.457-.984 19.58 0 7.642.42 14.015 1.283 19.481.99 6.266 2.298 10.896 4.115 14.563 2.18 4.535 4.756 7.801 7.873 9.978 3.464 2.457 7.414 3.755 11.428 3.755h270.369c4.266 0 8.349-1.298 11.813-3.755 3.271-2.284 6.015-5.784 7.951-10.139 1.776-3.639 3.062-8.226 4.037-14.401.862-5.467 1.282-11.839 1.282-19.481 0-8.125-.313-14.347-.987-19.614z"
                  />
                  <path
                    fill="#274C77"
                    id="b"
                    d="M212.299 276.443c5.523 0 10-4.478 10-10s-4.477-10-10-10h-.007c-5.523 0-9.996 4.478-9.996 10s4.48 10 10.003 10z"
                  />
                </defs>

                <use xlink:href="#a" />
                <use
                  xlink:href="#b"
                  fill-opacity="0"
                  stroke="#274C77"
                  stroke-width="5"
                  class="v3"
                />
              </svg>
            </b-col>
            <b-col>
              <h5>Fill out the form</h5>

              <button class="btn mx-auto" v-b-modal.modal2>View details</button>
              <b-modal
                id="modal2"
                size="lg"
                scrollable
                @ok="handleOk"
                title="Fill out the form and find out the total price of the project"
              >
                <b-alert
                  :show="dismissCountDown"
                  dismissible
                  variant="info"
                  @dismissed="dismissCountDown = 0"
                  @dismiss-count-down="countDownChanged"
                >
                  All quastions are requared.
                </b-alert>

                <v-question-item
                  :question_data="questions"
                  :questions_len="questions.length"
                  ref="sendAnswers"
                ></v-question-item>
              </b-modal>
            </b-col>
          </b-row>
        </b-col>
        <b-col class="w-100 m-5 anketa-box p-3">
          <b-row>
            <b-col class="col-3">
              <svg
                height="512"
                viewBox="0 0 511.999 511.999"
                width="512"
                xmlns="http://www.w3.org/2000/svg"
              >
                <defs>
                  <path
                    clip-rule="evenodd"
                    d="M418.214 461.956c0 7.269-.255 13.518-.893 18.619s-1.658 9.182-2.806 12.498c-1.275 3.188-2.933 5.484-4.846 6.887-2.04 1.403-4.336 2.04-6.759 2.04H124.774c-5.484 0-10.202-.51-14.156-1.531-3.953-1.02-7.269-2.933-9.692-5.739-2.55-2.933-4.336-7.014-5.484-12.497-1.148-5.484-1.658-12.625-1.658-21.297 0-8.289.383-15.303 1.148-21.169s2.04-11.095 4.081-15.686c2.04-4.591 4.591-9.055 7.652-13.39 3.188-4.464 7.141-9.182 12.243-14.411l83.785-89.524c16.706-17.471 30.224-33.284 40.426-47.695 10.202-14.283 18.236-27.418 23.975-39.278 5.738-11.86 9.564-22.7 11.732-32.647s3.188-19.512 3.188-28.439c0-8.162-1.276-15.941-3.954-23.337-2.55-7.269-6.504-13.646-11.605-19.129-5.101-5.484-11.477-9.692-19.257-12.88-7.652-3.061-16.706-4.591-27.291-4.591-14.666 0-27.674 1.913-39.023 5.611-11.35 3.698-21.297 7.907-29.841 12.498-8.672 4.719-15.814 8.927-21.552 12.753-5.739 3.953-10.202 5.866-13.391 5.866-2.295 0-4.208-.765-5.866-2.296-1.658-1.403-2.933-3.953-3.953-7.397-.893-3.57-1.785-8.162-2.423-14.155-.638-5.866-.893-13.008-.893-21.424 0-5.739.128-10.585.511-14.538a65.352 65.352 0 011.785-10.075c.638-2.806 1.658-5.356 2.933-7.524 1.275-2.041 3.443-4.591 6.503-7.652 3.188-2.933 8.927-6.759 17.216-11.35 8.417-4.719 18.619-9.182 30.862-13.518s25.633-8.034 40.426-11.095C217.867 11.531 233.17 10 249.111 10c25.251 0 47.185 3.188 66.059 9.565 18.747 6.376 34.432 15.176 46.93 26.525 12.497 11.35 21.68 24.74 27.801 40.299 6.121 15.558 9.182 32.264 9.182 50.246 0 15.686-1.53 31.117-4.463 46.293-3.061 15.303-9.31 31.626-18.747 49.225-9.437 17.471-22.827 36.983-40.044 58.28-17.216 21.297-40.044 46.037-68.482 74.221l-56.494 57.77H401.38c2.551 0 4.846.765 6.887 2.296 2.168 1.403 3.953 3.698 5.484 6.887 1.53 3.06 2.551 7.141 3.316 12.243.765 5.098 1.147 11.219 1.147 18.106z"
                    fill="#FFD037"
                    id="c"
                    fill-rule="evenodd"
                  />
                  <path
                    fill="#274C77"
                    id="d"
                    d="M426.956 442.363c-.976-6.497-2.317-11.316-4.223-15.153-2.315-4.801-5.178-8.304-8.741-10.694a21.305 21.305 0 00-12.611-4.093h-166.76l39.823-40.722c28.535-28.282 51.806-53.511 69.164-74.983 17.513-21.663 31.329-41.787 41.079-59.84 10.024-18.693 16.481-35.7 19.752-52.054 3.083-15.946 4.646-32.16 4.646-48.19 0-19.114-3.323-37.252-9.877-53.906-6.681-16.981-16.903-31.799-30.383-44.041-13.361-12.133-30.329-21.752-50.452-28.596C298.556 3.395 275.253 0 249.113 0c-16.317 0-32.424 1.566-47.937 4.67-14.967 3.097-29.01 6.953-41.737 11.462-12.877 4.561-23.479 9.212-32.369 14.196-8.951 4.957-15.212 9.124-19.141 12.737a10.3 10.3 0 00-.302.289c-3.63 3.631-6.218 6.712-7.912 9.422a8.794 8.794 0 00-.14.23c-1.818 3.09-3.173 6.526-4.027 10.217-.962 3.713-1.623 7.464-2.024 11.488-.386 3.981-.558 8.762-.558 15.502 0 9.256.312 16.618.948 22.482.606 5.7 1.479 10.778 2.667 15.525.035.138.072.275.112.411 1.641 5.541 3.84 9.376 6.91 12.045 3.481 3.146 7.798 4.809 12.498 4.809 5.432 0 11.469-2.41 18.994-7.584 5.369-3.575 12.149-7.584 20.68-12.226 8.183-4.396 17.673-8.366 28.208-11.799 10.422-3.396 22.509-5.119 35.925-5.119 9.215 0 17.147 1.304 23.498 3.844 6.544 2.682 11.688 6.097 15.728 10.438 4.269 4.59 7.462 9.849 9.523 15.722 2.228 6.154 3.357 12.861 3.357 19.935 0 8.448-.996 17.3-2.959 26.31-2.043 9.371-5.731 19.606-10.964 30.421-2.405 4.972-.325 10.952 4.646 13.357 4.967 2.402 10.951.326 13.357-4.646 5.917-12.23 10.123-23.964 12.501-34.873 2.269-10.406 3.418-20.691 3.418-30.568 0-9.401-1.531-18.398-4.519-26.649-2.946-8.396-7.562-16.008-13.719-22.629-6.054-6.507-13.507-11.519-22.864-15.354-8.804-3.521-19.234-5.306-31.005-5.306-15.524 0-29.696 2.054-42.121 6.104-11.661 3.8-22.251 8.239-31.524 13.222-9.139 4.973-16.438 9.296-22.318 13.216l-.126.085c-3.79 2.611-6.043 3.569-7.099 3.915-.199-.429-.476-1.112-.79-2.149-.934-3.778-1.63-7.893-2.13-12.593-.562-5.162-.834-11.816-.834-20.344 0-5.99.147-10.304.461-13.545.3-3.003.794-5.797 1.511-8.541.026-.104.052-.206.075-.31.379-1.664.976-3.232 1.729-4.548.529-.819 1.83-2.562 4.866-5.612 1.624-1.461 5.684-4.591 15.196-9.859 7.931-4.446 17.519-8.638 29.311-12.814 11.874-4.206 25.033-7.815 39.049-10.716C219.324 21.437 234.11 20 249.113 20c23.959 0 45.107 3.041 62.839 9.032 17.495 5.95 32.106 14.18 43.428 24.46 11.344 10.303 19.592 22.261 25.217 36.559 5.633 14.313 8.488 29.985 8.488 46.583 0 14.76-1.44 29.696-4.27 44.332-2.866 14.33-8.674 29.528-17.739 46.434-9.152 16.945-22.281 36.037-39.021 56.745-16.911 20.918-39.703 45.615-67.745 73.406a5.704 5.704 0 00-.11.11l-56.495 57.77a10.001 10.001 0 007.15 16.992h190.526c.387 0 .577.063.885.295.185.138.374.27.567.395.081.053.827.581 1.903 2.821l.07.143c.931 1.861 1.729 4.976 2.37 9.256.688 4.583 1.037 10.176 1.037 16.624 0 7.305-.267 12.989-.815 17.379-.472 3.774-1.229 7.214-2.25 10.227-.556 1.331-1.077 2.022-1.313 2.261-.169.087-.442.177-.925.177H124.774c-4.617 0-8.539-.408-11.656-1.212-2.036-.525-3.591-1.397-4.646-2.618-1.372-1.579-2.464-4.266-3.242-7.983-.959-4.584-1.445-11.061-1.445-19.25 0-7.774.358-14.462 1.063-19.877.681-5.224 1.762-9.449 3.304-12.918 1.764-3.97 4.012-7.9 6.651-11.639 3.035-4.252 6.72-8.583 11.263-13.24l.142-.149 83.75-89.486a667.767 667.767 0 0012.11-12.991c3.709-4.092 3.398-10.416-.693-14.125-4.09-3.708-10.415-3.4-14.125.693a655.355 655.355 0 01-11.858 12.719l-83.718 89.451c-5.229 5.367-9.529 10.44-13.179 15.551-3.425 4.852-6.325 9.931-8.619 15.094-2.336 5.255-3.926 11.292-4.859 18.456-.829 6.357-1.231 13.704-1.231 22.462 0 9.697.611 17.334 1.869 23.348 1.509 7.201 4.035 12.765 7.704 16.983 3.69 4.273 8.795 7.346 14.763 8.886 4.749 1.226 10.353 1.847 16.653 1.847h278.137c4.515 0 8.812-1.314 12.426-3.801.083-.057.164-.115.245-.174 3.495-2.563 6.261-6.344 8.219-11.238.058-.146.112-.293.164-.44 1.519-4.385 2.622-9.273 3.279-14.53.652-5.221.97-11.717.97-19.859-.001-7.443-.424-14.035-1.259-19.598z"
                  />
                  <path
                    fill="#274C77"
                    id="d"
                    d="M253.119 259.061c0-5.522-4.478-10-10-10h-.008c-5.522 0-9.996 4.478-9.996 10s4.481 10 10.004 10 10-4.478 10-10z"
                  />
                </defs>
                <use xlink:href="#c" />
                <use
                  xlink:href="#d"
                  fill-opacity="0"
                  stroke="#274C77"
                  stroke-width="5"
                  class="v3"
                />
              </svg>
            </b-col>
            <b-col id="tooltip">
              <h5>Send to analysis</h5>
              <button :disabled="Done" class="btn mx-auto">
                Send to analysis
              </button>
              <b-tooltip
                v-if="!done"
                variant="info"
                placement="bottom"
                target="tooltip"
                noninteractive
              >
                first of all fill out the form
              </b-tooltip>
            </b-col>
          </b-row>
        </b-col>
      </b-row>
    </b-container>
  </div>
</template>
<script>
import vQuestionItem from "./v-question-item.vue";
export default {
  components: { vQuestionItem },
  name: "v-form",
  data() {
    return {
      dismissSecs: 5,
      dismissCountDown: 0,
      done: false,

      answers: [],
      questions: [
        {
          id: "1",
          text: "Какие задачи должен решать чат-бот?",
          type: "selected",
          answers: [
            {
              id: 1,
              value: "обработка типовых сообщений ",
            },
            {
              id: 2,
              value: "рассылка подписчикам",
            },
            {
              id: 3,
              value: "фильтрация поступающих заявок",
            },
            {
              id: 4,
              value: "мгновенная реакция на сообщения ",
            },
          ],
        },
        {
          id: "2",
          text: "Где  должен размещаться чат-бот?",
          type: "checkbox",
          answers: [
            {
              id: 1,
              value: "сайт",
            },
            {
              id: 2,
              value: "мессенджеры",
            },
            {
              id: 3,
              value: "личный кабинет",
            },
            {
              id: 4,
              value: "мобильное  приложение",
            },
            {
              id: 5,
              value: "гаджет",
            },
          ],
        },
        {
          id: "3",
          text:
            "Укажите минимальное и максимальное кол-во посетителей приложения, в котором планируется использование чат-бота (для каждого канала)?",
          type: "range",
          answers: [0, 250],
        },
        {
          id: "4",
          text: "Введидте ожидаемая нагрузку (кол-во обращений) на чат-бота",
          type: "message",
          answers: [],
        },
        {
          id: "5",
          text: "Какой формат диалога предпочтительнее?",
          type: "checkbox",
          answers: [
            {
              id: 1,
              value: "Свободное общение",
            },
            {
              id: 2,
              value: "работа по фиксированному сценарию диалога ",
            },
          ],
        },
      ],
    };
  },
  methods: {
    showAlert() {
      this.dismissCountDown = this.dismissSecs;
    },
    handleOk(bvModalEvt) {
      // Prevent modal from closing
      bvModalEvt.preventDefault();
      // Trigger submit handler
      this.handleSubmit();
      // this.error = false;
    },
    handleSubmit() {
      // Exit when the form isn't valid
      this.answers = this.$refs.sendAnswers.sendAnswers();

      for (let i = 0; i < this.answers.length; i++) {
        console.log(this.answers[i]);
        if (this.answers[i] == null || this.answers[i].length == 0) {
          this.showAlert();
          return;
        }
      }
      if (this.answers.length != this.questions.length) {
        this.showAlert();
        return;
      }
      this.done = true;
      this.$nextTick(() => {
        this.$bvModal.hide("modal2");
      });
    },
  },
  computed: {
    Done() {
      return !this.done;
    },
  },
};
</script>
<style lang='scss'>
.v-form {
  a {
    font-size: 16px;
  }
}
</style>